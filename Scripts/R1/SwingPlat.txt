//------------Sonic CD Swing Platform Script-------------//
//--------Scripted by Christian Whitehead 'The Taxman'--------//
//-------Unpacked By Rubberduckycooly's Script Unpacker-------//

// Aliases
#alias Object.Value0	:	Object.Angle
#alias Object.Value1	:	Object.PlayerFloor.X
#alias Object.Value2	:	Object.PlayerFloor.Y
#alias Object.Value3	:	Object.XVelocity
#alias Object.Value4	:	Object.YVelocity
#alias Object.Value5	:	Object.Oscillation

#alias Object.PropertyValue	:	Object.ChainLength

sub ObjectMain
	Object.Oscillation += 2
	Object.Oscillation &= 511

	Sin(Object.Angle, Object.Oscillation)
	Object.Angle >>= 2
	Object.Angle += 128

	TempValue1 = Object.PropertyValue
	TempValue1++
	TempValue1 <<= 4

	Cos(Object.XVelocity, Object.Angle)
	Object.XVelocity *= TempValue1
	Object.XVelocity <<= 7
	Object.XVelocity += Object.XPos
	Object.XVelocity &= -65536
	Object.XVelocity -= Object.PlayerFloor.X

	Sin(Object.YVelocity, Object.Angle)
	Object.YVelocity *= TempValue1
	Object.YVelocity <<= 7
	Object.YVelocity += Object.YPos
	Object.YVelocity &= -65536
	Object.YVelocity -= Object.PlayerFloor.Y
end sub


sub ObjectPlayerInteraction
	TempValue0 = Object.XPos
	TempValue1 = Object.YPos

	Object.XPos = Object.PlayerFloor.X
	Object.YPos = Object.PlayerFloor.Y

	PlayerObjectCollision(C_PLATFORM, -24, -6, 24, 8)
	if CheckResult == true
		Player.XPos += Object.XVelocity
		Player.YPos += Object.YVelocity
	end if

	Object.XPos = TempValue0
	Object.YPos = TempValue1
end sub


sub ObjectDraw
	DrawSprite(0)
	TempValue0 = 0
	TempValue1 = 16
	while TempValue0 < Object.PropertyValue
		Cos(TempValue2, Object.Angle)
		TempValue2 *= TempValue1
		TempValue2 <<= 7
		TempValue2 += Object.XPos

		Sin(TempValue3, Object.Angle)
		TempValue3 *= TempValue1
		TempValue3 <<= 7
		TempValue3 += Object.YPos

		DrawSpriteXY(1, TempValue2, TempValue3)

		TempValue0++

		TempValue1 += 16
	loop

	Cos(Object.Value1, Object.Angle)
	Object.PlayerFloor.X *= TempValue1
	Object.PlayerFloor.X <<= 7
	Object.PlayerFloor.X += Object.XPos
	Object.PlayerFloor.X &= -65536

	Sin(Object.PlayerFloor.Y, Object.Angle)
	Object.PlayerFloor.Y *= TempValue1
	Object.PlayerFloor.Y <<= 7
	Object.PlayerFloor.Y += Object.YPos
	Object.PlayerFloor.Y &= -65536

	DrawSpriteXY(2, Object.PlayerFloor.X, Object.PlayerFloor.Y)
end sub


sub ObjectStartup
	LoadSpriteSheet("R1/Objects2.gif")

	SpriteFrame(-8, -8, 16, 16, 173, 230)		// #0 - Connection Joint
	SpriteFrame(-8, -8, 16, 16, 190, 230)		// #1 - Chain
	SpriteFrame(-24, -8, 48, 16, 207, 230)		// #2 - Platform
end sub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0, SingleIcon, -16, -16, 32, 32, 1, 143)
end sub
