//------------Sonic CD Menu Control Script-------------//
//--------Scripted by Christian Whitehead 'The Taxman'--------//
//-------Unpacked By Rubberduckycooly's Script Unpacker-------//

// Aliases
#alias Object.Value0	:	Object.Timer	// Also used for fading
#alias Object[32].State	:	Object.LEState

// States
#alias 0	:	MENUCONTROL_SETUP
#alias 1	:	MENUCONTROL_FADEIN
#alias 2	:	MENUCONTROL_CONTROLS
#alias 3	:	MENUCONTROL_BLANK
#alias 4	:	MENUCONTROL_EXIT

// LEntry States
#alias 1	: LENTRY_MOVE_RIGHT
#alias 4	: LENTRY_MOVE_LEFT
#alias 7	: LENTRY_MOVE_DOWN
#alias 10	: LENTRY_MOVE_UP

// Engine & Callbacks
#alias 3	: CALLBACK_TIMEATTACK_NOTIFY_EXIT

sub ObjectMain
#platform: Mobile
	switch Object.State
	case MENUCONTROL_SETUP
		Object.State = MENUCONTROL_FADEIN
		Object.Timer = 384
		SetScreenFade(0, 0, 0, 255)
		PlayMusic(0)
		break

	case MENUCONTROL_FADEIN
		if Object.Timer > 0
			Object.Timer -= 8
			Object.Scale -= 4096
		else
			Object.State = MENUCONTROL_CONTROLS
		end if
		SetScreenFade(0, 0, 0, Object.Value0)
		break

	case MENUCONTROL_CONTROLS
		if KeyPress.Left == true
			Object.State = MENUCONTROL_BLANK
			Object.LEState = LENTRY_MOVE_LEFT
			PlaySfx(23, 0) 	//Menu Button SFX
		end if

		if KeyPress.Right == true
			Object.State = MENUCONTROL_BLANK
			Object.LEState = LENTRY_MOVE_RIGHT
			PlaySfx(23, 0) 	//Menu Button SFX
		end if

		if KeyPress.Up == true
			Object.State = MENUCONTROL_BLANK
			Object.LEState = LENTRY_MOVE_UP
			PlaySfx(23, 0) 	//Menu Button SFX
		end if

		if KeyPress.Down == true
			Object.State = MENUCONTROL_BLANK
			Object.LEState = LENTRY_MOVE_DOWN
			PlaySfx(23, 0) 	//Menu Button SFX
		end if

		if KeyPress.ButtonB == true
			Object.State = MENUCONTROL_EXIT
			StopMusic()
			PlaySfx(27, 0)	//Select SFX
		end if
		break

	case MENUCONTROL_BLANK
		break

	case MENUCONTROL_EXIT
		if Object.Timer < 384
			Object.Timer += 8
			Object.Scale += 4096
		else
			Stage.ListPos = 1	// Menu
			LoadStage()
		end if
		SetScreenFade(0, 0, 0, Object.Timer)
		EngineCallback(CALLBACK_TIMEATTACK_NOTIFY_EXIT)
		break

	end switch
#endplatform
end sub


sub ObjectStartup
#platform: Mobile
	if Options.Soundtrack == 0
		SetMusicTrack("JP/TimeAttack.ogg", 0, 0x188A0)
	else
		SetMusicTrack("US/DAGarden.ogg", 0, 0x1CA86)
	end if
	Object[0].Type = TypeName[MenuControl]
	Object[0].DrawOrder = 1
	Options.PhysicalControls = 0
#endplatform
end sub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0, SingleIcon, -16, -16, 32, 32, 1, 143)
end sub
