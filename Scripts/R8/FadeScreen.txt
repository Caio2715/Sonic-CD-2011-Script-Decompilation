//-----------------Sonic CD FadeScreen Script-----------------//
//--------Scripted by Christian Whitehead 'The Taxman'--------//
//-------Unpacked By Rubberduckycooly's Script Unpacker-------//

// Aliases
#alias 62: TYPE_FADESCREEN


sub ObjectMain
	switch Object.State
	case 0
		if Object.Value0 < 480
			Object.Value0 += 4
			Music.Volume--
		else
			Object.Value0 = 224
			if Object.PropertyValue == 0
				Object.State++
			else
				Object.State += 2
			end if
		end if

		if Object.PropertyValue == 1
			SetScreenFade(0, 0, 0, Object.Value0)
		else
			SetScreenFade(224, 224, 224, Object.Value0)
		end if
		break
	case 1
		if Object.Value0 > 0
			Music.Volume--
			Object.Value0 -= 16
		else
			StopMusic()
			if Options.GameMode == 2
				TimeAttack.Result = Stage.Seconds
				TimeAttack.Result *= 100
				TempValue0 = Stage.Minutes
				TempValue0 *= 6000
				TimeAttack.Result += TempValue0
				TimeAttack.Result += Stage.MilliSeconds
				TempValue0 = Stage.ListPos
				TempValue0 %= 10
				TempValue0 >>= 2
				TempValue1 = Stage.ListPos
				TempValue1 /= 10
				TempValue1 *= 3
				TempValue0 += TempValue1
				TempValue0++
				TempValue1 = Stage.Seconds
				TempValue1 *= 100
				TempValue2 = Stage.Minutes
				TempValue2 *= 6000
				TempValue1 += TempValue2
				TempValue1 += Stage.MilliSeconds
				SetLeaderboard(TempValue0, TempValue1)
				Stage.ListPos = 2
			else
				if Stage.PlayerListPos == 0
#platform: Mobile
					EngineCallback(4)
#endplatform
#platform: Standard
					if Stage.DebugMode == 0
						SetAchievement(7, 100)
					end if
					TempValue0 = Stage.ListPos
					TempValue0 %= 10
					TempValue0 >>= 2
					TempValue1 = Stage.ListPos
					TempValue1 /= 10
					TempValue1 *= 3
					TempValue0 += TempValue1
					TempValue0++
					TempValue1 = Stage.Seconds
					TempValue1 *= 100
					TempValue2 = Stage.Minutes
					TempValue2 *= 6000
					TempValue1 += TempValue2
					TempValue1 += Stage.MilliSeconds
					SetLeaderboard(TempValue0, TempValue1)
#endplatform
					if Player.Score > 0
#platform: Mobile
						if Options.GameMode == 1
							if Stage.DebugMode == 0
#endplatform
								SetLeaderboard(0, Player.Score)
#platform: Mobile
							end if
						end if
#endplatform
					end if
#platform: Standard
					EngineCallback(4)
#endplatform
					if SpecialStage.TimeStones > 126
#platform: Standard
						LoadVideo("Good_Ending")
#endplatform
#platform: Mobile
						if Options.Soundtrack == 0
							LoadVideo("Good_Ending")
						else
							LoadVideo("Good_EndingUS")
						end if
#endplatform
					else
						if Good_Future_List > 16382
#platform: Standard
							LoadVideo("Good_Ending")
#endplatform
#platform: Mobile
							if Options.Soundtrack == 0
								LoadVideo("Good_Ending")
							else
								LoadVideo("Good_EndingUS")
							end if
#endplatform
						else
#platform: Standard
							LoadVideo("Bad_Ending")
#endplatform
#platform: Mobile
							if Options.Soundtrack == 0
								LoadVideo("Bad_Ending")
							else
								LoadVideo("Bad_EndingUS")
							end if
#endplatform
						end if
					end if
					if SaveRAM[36] == 0
						SaveRAM[36] = 1
						WriteSaveRAM()
						Stage.ListPos = 8
					else
						Stage.ListPos = 1
					end if
				else
					Stage.ListPos = 7
				end if
			end if
			Stage.ActiveList = PRESENTATION_STAGE
			LoadStage()
		end if
		SetScreenFade(Object.Value0, Object.Value0, Object.Value0, 255)
		break
	case 2
		if Object.Value0 > 0
			Music.Volume--
			Object.Value0 -= 16
		else
			StopMusic()
			Stage.ListPos += 2
			LoadStage()
		end if
		break
	end switch
end sub

// ========================
// Editor Subs
// ========================

sub RSDKDraw
	DrawSprite(0)
end sub

sub RSDKLoad
	LoadSpriteSheet("Global/Display.gif")
	SpriteFrame(-16, -16, 32, 32, 1, 143)		// #0 - "Script" Icon

	SetVariableAlias(ALIAS_VAR_PROPVAL, "unused")
end sub
