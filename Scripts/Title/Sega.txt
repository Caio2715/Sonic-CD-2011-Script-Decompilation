//------------Sonic CD Sega Script-------------//
//--------Scripted by Christian Whitehead 'The Taxman'--------//
//-------Unpacked By Rubberduckycooly's Script Unpacker-------//

// Aliases
#alias Object.Value0 : Object.Fade
#alias Object.Value1 : Object.RectAlpha // Only Used in Mobile

// States
#alias 0 : SEGA_SETUP
#alias 1 : SEGA_FADEIN
#alias 2 : SEGA_JINGLE
#alias 3 : SEGA_FADEOUT

// Callbacks & Engine States
#alias 0 : CALLBACK_DISPLAYLOGOS
#alias 7 : CALLBACK_EXIT_SELECTED

#alias 5 : ENGINE_ENTER_HIRESMODE

sub ObjectMain
	switch Object.State
	case SEGA_SETUP
		ReadSaveRAM()
		if SaveRAM[32] == 1
			Engine.BGMVolume = SaveRAM[33]
			Engine.SFXVolume = SaveRAM[34]
#platform: Use_Haptics
			Engine.HapticsEnabled = SaveRAM[40]
#endplatform
		end if
#platform: Mobile
		Options.Soundtrack = SaveRAM[38]
		Object.State = SEGA_FADEIN
		Object.Fade = 384
		Object.Alpha = 255
		Object.InkEffect = 2
		SetScreenFade(0, 0, 0, 255)
#endplatform
		Object.iXPos = Screen.CenterX
#platform: Standard
		Object.Type = TypeName[Sonic]
		EngineCallback(CALLBACK_DISPLAYLOGOS)
#endplatform
#platform: Mobile
		Engine.State = ENGINE_ENTER_HIRESMODE
#endplatform
		break

	case SEGA_FADEIN
		if Object.Fade > 0
			Object.Fade -= 8
		else
			if Engine.OnlineActive < 2
				Object.State = SEGA_JINGLE
			end if
		end if
		SetScreenFade(0, 0, 0, Object.Fade)
		break

	case SEGA_JINGLE
		Object.Fade++
		if Object.Fade == 160
			Object.Fade = 0
			Object.State = SEGA_FADEOUT
		end if
		if Object.Fade == 2
			PlayStageSfx(0, 0)	//Sega SFX
		end if
		break

	case SEGA_FADEOUT
#platform: Mobile
		if Object.RectAlpha < 256
			Object.RectAlpha += 8
		end if
#endplatform
		if Object.Alpha > 7
			Object.Alpha -= 8
		else
			if Object.Fade == 16
				ResetObjectEntity(Object.EntityNo, TypeName[CWLogo], 0, Object.XPos, Object.YPos)
				Object.InkEffect = 2
				Object.Alpha = 0
				Object.Fade = 0
#platform: Mobile
				Object.Value3 = 96	//Unknown Use
#endplatform
			else
				Object.Fade++
			end if
		end if
		break
		
	end switch
	
#platform: Mobile
	if Engine.PlatformID == RETRO_WP7
		if KeyPress.ButtonB == true
			EngineCallback(CALLBACK_EXIT_SELECTED)
		end if
	end if
#endplatform
end sub



sub ObjectDraw
	DrawRect(0, 0, Screen.XSize, Screen.YSize, 0, 0, 96, 255)
#platform: Standard
	if Object.Alpha > 8
		DrawSpriteFX(0, FX_INK, Object.XPos, Object.YPos)
	end if
#endplatform

#platform: Mobile
	Object.Scale = 128
	DrawSpriteFX(0, FX_SCALE, Object.XPos, Object.YPos)
	DrawRect(0, 0, Screen.XSize, Screen.YSize, 0, 0, 96, Object.RectAlpha)
#endplatform
end sub


sub ObjectStartup
#platform: Standard
	LoadSpriteSheet("Title/Title.gif")
	SpriteFrame(-49, -16, 98, 31, 106, 1)	// #0 - '93 Sega Logo(Unused)
#endplatform

#platform: Mobile
	LoadSpriteSheet("Title/Sega.gif")
	SpriteFrame(-255, -87, 510, 174, 1, 1)	// #0 - Sega Logo
#endplatform
end sub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0, SingleIcon, -16, -16, 32, 32, 1, 143)
end sub
